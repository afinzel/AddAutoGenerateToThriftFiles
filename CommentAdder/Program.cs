using System.IO;

namespace CommentAdder
{
    class Program
    {
        static void Main(string[] args)
        {
            Go(args[0]);
        }

        private static void Go(string dir)
        {
            foreach (var subDir in Directory.GetDirectories(dir))
            {
                foreach (var f in Directory.GetFiles(subDir))
                {
                    if (f.EndsWith(".cs"))
                    {
                        AddComment(f, "// <auto-generated />");
                    }
                }

                Go(subDir);
            }
        }

        private static void AddComment(string filename, string comment)
        {
            string contents;

            using (var sr = new StreamReader(filename))
            {
                contents = sr.ReadToEnd();
                sr.Close();
            }

            if (contents.StartsWith(comment)) return;

            using (var writer = new StreamWriter(filename))
            {
                writer.WriteLine(comment);
                writer.Write(contents);
                writer.Close();
            }
        }
    }
}
